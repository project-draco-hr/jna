{
  PointerByReference bufptr=new PointerByReference();
  try {
    int rc=Netapi32.INSTANCE.NetGetDCName(domainName,serverName,bufptr);
    if (LMErr.NERR_Success != rc) {
      throw new LastErrorException(rc);
    }
    return bufptr.getValue().getString(0);
  }
  finally {
    if (W32Errors.ERROR_SUCCESS != Netapi32.INSTANCE.NetApiBufferFree(bufptr.getValue())) {
      throw new LastErrorException(Kernel32.INSTANCE.GetLastError());
    }
  }
}
