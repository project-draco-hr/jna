{
  Kernel32 lib=Kernel32.INSTANCE;
  PointerByReference pref=new PointerByReference();
  lib.FormatMessage(WinBase.FORMAT_MESSAGE_ALLOCATE_BUFFER | WinBase.FORMAT_MESSAGE_FROM_SYSTEM | WinBase.FORMAT_MESSAGE_IGNORE_INSERTS,null,code,0,pref,0,null);
  String s=pref.getValue().getString(0,!Boolean.getBoolean("w32.ascii"));
  s=s.replace(".\r",".").replace(".\n",".");
  lib.LocalFree(pref.getValue());
  return s;
}
