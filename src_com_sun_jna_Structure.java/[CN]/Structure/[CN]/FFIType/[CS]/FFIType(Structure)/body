{
  initFieldOrder();
  Pointer[] els;
  ref.ensureAllocated(true);
  if (ref instanceof Union) {
    StructField sf=((Union)ref).biggestField;
    els=new Pointer[]{get(ref.getFieldValue(sf.field),sf.type),null};
  }
 else {
    els=new Pointer[ref.fields().size() + 1];
    int idx=0;
    for (Iterator i=ref.fields().values().iterator(); i.hasNext(); ) {
      StructField sf=(StructField)i.next();
      els[idx++]=ref.getFieldTypeInfo(sf);
    }
  }
  init(els);
}
