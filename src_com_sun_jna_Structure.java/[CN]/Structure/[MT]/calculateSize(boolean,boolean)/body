{
  int size=CALCULATE_SIZE;
  LayoutInfo info;
synchronized (layoutInfo) {
    info=(LayoutInfo)layoutInfo.get(getClass());
  }
  if (info == null || this.alignType != info.alignType || this.typeMapper != info.typeMapper || (this.fieldOrder != null && !this.fieldOrder.equals(info.fieldOrder))) {
    info=deriveLayout(force,avoidFFIType);
  }
  if (info != null) {
    this.structAlignment=info.alignment;
    this.structFields=info.fields;
    info.alignType=this.alignType;
    info.typeMapper=this.typeMapper;
    info.fieldOrder=this.fieldOrder;
    if (!info.variable) {
synchronized (layoutInfo) {
        layoutInfo.put(getClass(),info);
      }
    }
    size=info.size;
  }
  return size;
}
