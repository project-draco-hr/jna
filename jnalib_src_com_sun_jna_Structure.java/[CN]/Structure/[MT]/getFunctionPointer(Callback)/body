{
  if (cb == null)   return null;
  if (Proxy.isProxyClass(cb.getClass()) && Proxy.getInvocationHandler(cb) instanceof NativeCallbackHandler) {
    NativeCallbackHandler handler=(NativeCallbackHandler)Proxy.getInvocationHandler(cb);
    return handler.getPointer();
  }
  CallbackReference cbref=CallbackReference.getInstance(cb);
  return cbref.getTrampoline();
}
