{
  int alignment=1;
  int size=getNativeSize(type,value);
  if (type.isPrimitive() || Long.class == type || Integer.class == type || Short.class == type || Character.class == type || Byte.class == type || Float.class == type || Double.class == type) {
    alignment=size;
  }
 else   if (Pointer.class == type || Buffer.class.isAssignableFrom(type) || Callback.class.isAssignableFrom(type) || WString.class == type || String.class == type) {
    alignment=Pointer.SIZE;
  }
 else   if (Structure.class.isAssignableFrom(type)) {
    if (ByReference.class.isAssignableFrom(type)) {
      alignment=Pointer.SIZE;
    }
 else {
      if (value == null)       value=newInstance(type);
      alignment=((Structure)value).structAlignment;
    }
  }
 else   if (type.isArray()) {
    alignment=getNativeAlignment(type.getComponentType(),null,isFirstElement);
  }
 else {
    throw new IllegalArgumentException("Type " + type + " has unknown "+ "native alignment");
  }
  if (alignType == ALIGN_NONE)   return 1;
  if (alignType == ALIGN_MSVC)   return Math.min(8,alignment);
  if (alignType == ALIGN_GNUC) {
    if (!isFirstElement || !isPPC)     return Math.min(MAX_GNUC_ALIGNMENT,alignment);
  }
  return alignment;
}
