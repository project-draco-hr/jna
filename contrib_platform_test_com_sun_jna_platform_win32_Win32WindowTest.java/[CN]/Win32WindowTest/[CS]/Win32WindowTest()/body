{
  WString windowClass=new WString("MyWindowClass");
  HMODULE hInst=Kernel32.INSTANCE.GetModuleHandle("");
  WNDCLASSEX wClass=new WNDCLASSEX();
  wClass.hInstance=hInst;
  wClass.lpfnWndProc=Win32WindowTest.this;
  wClass.lpszClassName=windowClass;
  User32.INSTANCE.RegisterClassEx(wClass);
  getLastError();
  HWND hWnd=User32.INSTANCE.CreateWindowEx(User32.WS_EX_TOPMOST,windowClass,"My hidden helper window, used only to catch the windows events",0,0,0,0,0,WinUser.HWND_MESSAGE,null,hInst,null);
  getLastError();
  System.out.println("window sucessfully created! window hwnd: " + hWnd.getPointer().toString());
  Wtsapi32.INSTANCE.WTSRegisterSessionNotification(hWnd,Wtsapi32.NOTIFY_FOR_THIS_SESSION);
  MSG msg=new MSG();
  while (User32.INSTANCE.GetMessage(msg,hWnd,0,0) != 0) {
    User32.INSTANCE.TranslateMessage(msg);
    User32.INSTANCE.DispatchMessage(msg);
  }
  Wtsapi32.INSTANCE.WTSUnRegisterSessionNotification(hWnd);
  User32.INSTANCE.UnregisterClass(windowClass,hInst);
  User32.INSTANCE.DestroyWindow(hWnd);
  System.out.println("program exit!");
}
