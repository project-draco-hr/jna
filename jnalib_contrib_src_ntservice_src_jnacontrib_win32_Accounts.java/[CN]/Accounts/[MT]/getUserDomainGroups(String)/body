{
  Netapi32 netapi32;
  PointerByReference buf;
  IntByReference entriesread;
  IntByReference totalentries;
  Netapi32.GROUP_USERS_INFO_0 group;
  Structure[] groups;
  TreeSet<String> domainGroups;
  int i;
  domainGroups=new TreeSet<String>(String.CASE_INSENSITIVE_ORDER);
  netapi32=Netapi32.INSTANCE;
  buf=new PointerByReference();
  entriesread=new IntByReference();
  totalentries=new IntByReference();
  if (netapi32.NetUserGetGroups(getDomainControllerName(),userName,0,buf,LMCONS.MAX_PREFERRED_LENGTH,entriesread,totalentries) == LMERR.NERR_Success) {
    group=new Netapi32.GROUP_USERS_INFO_0(buf.getValue());
    groups=group.toArray(entriesread.getValue());
    for (i=0; i < entriesread.getValue(); i++) {
      group=(Netapi32.GROUP_USERS_INFO_0)groups[i];
      domainGroups.add(group.grui0_name);
    }
    if (entriesread.getValue() > 0) {
      netapi32.NetApiBufferFree(buf.getValue());
    }
  }
  return (domainGroups);
}
