{
  String result="";
  int rc=0;
  String[] regCLSIDkeys=Advapi32Util.registryGetKeys(WinReg.HKEY_CLASSES_ROOT,"CLSID");
  for (int i=0; i < regCLSIDkeys.length; i++) {
    String value=Advapi32Util.registryGetStringValue(WinReg.HKEY_CLASSES_ROOT,"CLSID\\{" + regCLSIDkeys[i] + "}",null);
    System.out.println(value);
  }
  String subKey="CLSID";
  HKEYByReference phkResult=new HKEYByReference();
  rc=Advapi32.INSTANCE.RegOpenKeyEx(WinReg.HKEY_CLASSES_ROOT,"CLSID",0,WinNT.KEY_READ,phkResult);
  checkRegistryRC(rc);
  IntByReference lpcSubKeys=new IntByReference();
  rc=Advapi32.INSTANCE.RegQueryInfoKey(phkResult.getValue(),null,null,null,lpcSubKeys,null,null,null,null,null,new IntByReference(WinNT.KEY_READ),null);
  checkRegistryRC(rc);
  for (int i=1; i < lpcSubKeys.getValue(); i++) {
    char[] lpName=new char[WinNT.MAX_PATH];
    IntByReference lpcClass=new IntByReference(WinNT.MAX_PATH);
    rc=Advapi32.INSTANCE.RegEnumKeyEx(phkResult.getValue(),i,lpName,lpcClass,null,null,null,null);
    checkRegistryRC(rc);
    subKey=Native.toString(lpName);
    HKEYByReference phkResult2=new HKEYByReference();
    rc=Advapi32.INSTANCE.RegOpenKeyEx(phkResult.getValue(),subKey,0,WinNT.KEY_READ,phkResult2);
    checkRegistryRC(rc);
    for (int y=0; y < 2; y++) {
      char[] lpName2=new char[WinNT.MAX_PATH];
      IntByReference lpcClass2=new IntByReference(WinNT.MAX_PATH);
      rc=Advapi32.INSTANCE.RegEnumKeyEx(phkResult2.getValue(),1,lpName2,lpcClass2,null,null,null,null);
      checkRegistryRC(rc);
      String subKey2=Native.toString(lpName2);
      if (subKey2.equals("ProgID")) {
        HKEYByReference phkResult3=new HKEYByReference();
        rc=Advapi32.INSTANCE.RegOpenKeyEx(phkResult2.getValue(),subKey2,0,WinNT.KEY_READ,phkResult3);
        checkRegistryRC(rc);
        IntByReference lpcbData=new IntByReference();
        rc=Advapi32.INSTANCE.RegQueryValueEx(phkResult3.getValue(),null,0,null,(char[])null,lpcbData);
        checkRegistryRC(rc);
        char[] lpData=new char[lpcbData.getValue()];
        rc=Advapi32.INSTANCE.RegQueryValueEx(phkResult3.getValue(),null,0,null,lpData,lpcbData);
        checkRegistryRC(rc);
        result+=Native.toString(lpData) + "\n";
      }
    }
  }
  return result;
}
