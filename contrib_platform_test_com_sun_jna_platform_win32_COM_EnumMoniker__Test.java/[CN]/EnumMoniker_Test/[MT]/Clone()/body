{
  PointerByReference pprot=new PointerByReference();
  HRESULT hr=Ole32.INSTANCE.GetRunningObjectTable(new DWORD(0),pprot);
  COMUtils.checkRC(hr);
  IRunningObjectTable rot=new RunningObjectTable(pprot.getValue());
  PointerByReference ppenumMoniker=new PointerByReference();
  hr=rot.EnumRunning(ppenumMoniker);
  COMUtils.checkRC(hr);
  IEnumMoniker iterator1=new EnumMoniker(ppenumMoniker.getValue());
  hr=iterator1.Reset();
  COMUtils.checkRC(hr);
  PointerByReference rgelt1=new PointerByReference();
  ULONGByReference pceltFetched1=new ULONGByReference();
  hr=iterator1.Next(new ULONG(1),rgelt1,pceltFetched1);
  COMUtils.checkRC(hr);
  PointerByReference ppenum=new PointerByReference();
  hr=iterator1.Clone(ppenum);
  COMUtils.checkRC(hr);
  IEnumMoniker iterator2=new EnumMoniker(ppenum.getValue());
  PointerByReference rgelt2=new PointerByReference();
  ULONGByReference pceltFetched2=new ULONGByReference();
  hr=iterator2.Next(new ULONG(1),rgelt2,pceltFetched2);
  COMUtils.checkRC(hr);
  assertNotEquals(rgelt1.getValue(),rgelt2.getValue());
  rgelt1=new PointerByReference();
  pceltFetched1=new ULONGByReference();
  hr=iterator1.Next(new ULONG(1),rgelt1,pceltFetched1);
  COMUtils.checkRC(hr);
  assertEquals(rgelt1.getValue(),rgelt2.getValue());
}
