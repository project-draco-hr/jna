{
  final int MAGIC=0xABEDCF23;
  Map options=new HashMap();
  DefaultTypeMapper mapper=new DefaultTypeMapper();
  mapper.addToNativeConverter(Boolean.class,new ToNativeConverter(){
    public Object toNative(    Object value,    ToNativeContext ctx){
      return new Integer(Boolean.TRUE.equals(value) ? MAGIC : 0);
    }
    public Class nativeType(){
      return Integer.class;
    }
  }
);
  mapper.addFromNativeConverter(Boolean.class,new FromNativeConverter(){
    public Object fromNative(    Object value,    FromNativeContext context){
      return Boolean.valueOf(((Integer)value).intValue() == MAGIC);
    }
    public Class nativeType(){
      return Integer.class;
    }
  }
);
  options.put(Library.OPTION_TYPE_MAPPER,mapper);
  BooleanTestLibrary lib=Native.loadLibrary("testlib",BooleanTestLibrary.class,options);
  assertEquals("Failed to convert integer return to boolean TRUE",true,lib.returnInt32Argument(true));
  assertEquals("Failed to convert integer return to boolean FALSE",false,lib.returnInt32Argument(false));
}
