{
  final int[] called={0};
  final boolean[] daemon={false};
  final String[] name={null};
  final ThreadGroup[] group={null};
  final Thread[] t={null};
  ThreadGroup testGroup=new ThreadGroup(getName());
  CallbackThreadInitializer init=new CallbackThreadInitializer(true,true,getName(),testGroup);
  TestLibrary.VoidCallback cb=new TestLibrary.VoidCallback(){
    public void callback(){
      Thread thread=Thread.currentThread();
      daemon[0]=thread.isDaemon();
      name[0]=thread.getName();
      group[0]=thread.getThreadGroup();
      t[0]=thread;
      ++called[0];
    }
  }
;
  callCallback(cb,init,1,100,called);
  assertTrue("Callback thread not attached as daemon",daemon[0]);
  assertEquals("Wrong thread name",getName(),name[0]);
  assertEquals("Wrong thread group",testGroup,group[0]);
}
