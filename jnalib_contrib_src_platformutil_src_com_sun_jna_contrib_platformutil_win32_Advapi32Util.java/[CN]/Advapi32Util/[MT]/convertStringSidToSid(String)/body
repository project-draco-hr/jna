{
  PointerByReference sidBytes=new PointerByReference();
  if (!Advapi32.INSTANCE.ConvertStringSidToSid(sid,sidBytes)) {
    throw new LastErrorException(Kernel32.INSTANCE.GetLastError());
  }
  int sidLength=Advapi32.INSTANCE.GetLengthSid(sidBytes);
  byte[] result=sidBytes.getValue().getByteArray(0,sidLength);
  Kernel32.INSTANCE.LocalFree(sidBytes.getValue());
  return result;
}
