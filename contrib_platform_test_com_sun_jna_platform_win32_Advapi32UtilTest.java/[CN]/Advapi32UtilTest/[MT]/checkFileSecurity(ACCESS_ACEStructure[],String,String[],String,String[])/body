{
  int remainingUsr=userUnderTestSID == null ? 0 : expectedUsrMasks.length;
  int remainingGrp=groupUnderTestSID == null ? 0 : expectedGrpMasks.length;
  for (  ACCESS_ACEStructure aces : fileSecurity) {
    if (userUnderTestSID != null && aces.getSidString().equals(userUnderTestSID)) {
      String start=(aces.AceFlags & WinNT.VALID_INHERIT_FLAGS) + " " + aces.AceType+ " ";
      for (      String expected : expectedUsrMasks) {
        if (expected.startsWith(start)) {
          String gotMask=start + getFileSecurityAsString(aces.Mask);
          System.out.println(expected);
          remainingUsr--;
          assertEquals(expected,gotMask);
        }
      }
    }
    if (groupUnderTestSID != null && aces.getSidString().equals(groupUnderTestSID)) {
      String start=(aces.AceFlags & WinNT.VALID_INHERIT_FLAGS) + " " + aces.AceType+ " ";
      for (      String expected : expectedGrpMasks) {
        if (expected.startsWith(start)) {
          String gotMask=start + getFileSecurityAsString(aces.Mask);
          System.out.println(expected);
          remainingGrp--;
          assertEquals(expected,gotMask);
        }
      }
    }
  }
  assertEquals("Not all ACLs found for user ",0,remainingUsr);
  assertEquals("Not all ACLs found for group ",0,remainingGrp);
}
