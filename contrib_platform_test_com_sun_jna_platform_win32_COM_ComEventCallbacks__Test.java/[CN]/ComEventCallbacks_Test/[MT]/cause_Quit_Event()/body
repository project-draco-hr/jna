{
  CLSID clsid=new CLSID("{000209FF-0000-0000-C000-000000000046}");
  PointerByReference ppWordApp=new PointerByReference();
  HRESULT hr=Ole32.INSTANCE.CoCreateInstance(clsid,null,WTypes.CLSCTX_SERVER,IDispatch.IID_IDISPATCH,ppWordApp);
  COMUtils.checkRC(hr);
  Unknown unk=new Unknown(ppWordApp.getValue());
  PointerByReference ppCpc=new PointerByReference();
  IID cpcIID=new IID("{B196B284-BAB4-101A-B69C-00AA00341D07}");
  hr=unk.QueryInterface(new REFIID.ByValue(cpcIID),ppCpc);
  COMUtils.checkRC(hr);
  ConnectionPointContainer cpc=new ConnectionPointContainer(ppCpc.getValue());
  IID appEvnts4=new IID(APPLICATION_EVENTS_4);
  REFIID riid=new REFIID(appEvnts4.getPointer());
  PointerByReference ppCp=new PointerByReference();
  hr=cpc.FindConnectionPoint(riid,ppCp);
  COMUtils.checkRC(hr);
  final ConnectionPoint cp=new ConnectionPoint(ppCp.getValue());
  IID cp_iid=new IID();
  hr=cp.GetConnectionInterface(cp_iid);
  COMUtils.checkRC(hr);
  final Application_Events4 listener=new Application_Events4();
  final DWORDByReference pdwCookie=new DWORDByReference();
  HRESULT hr1=cp.Advise(listener,pdwCookie);
  COMUtils.checkRC(hr1);
  Dispatch d=new Dispatch(ppWordApp.getValue());
  DISPID dispIdMember=new DISPID(1105);
  REFIID.ByValue niid=new REFIID.ByValue(Guid.IID_NULL);
  LCID lcid=Kernel32.INSTANCE.GetSystemDefaultLCID();
  WinDef.WORD wFlags=new WinDef.WORD(1);
  DISPPARAMS.ByReference pDispParams=new DISPPARAMS.ByReference();
  VARIANT.ByReference pVarResult=new VARIANT.ByReference();
  IntByReference puArgErr=new IntByReference();
  EXCEPINFO.ByReference pExcepInfo=new EXCEPINFO.ByReference();
  hr=d.Invoke(dispIdMember,niid,lcid,wFlags,pDispParams,pVarResult,pExcepInfo,puArgErr);
  COMUtils.checkRC(hr);
  try {
    Thread.sleep(200);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  Assert.assertTrue(listener.Invoke_called);
}
