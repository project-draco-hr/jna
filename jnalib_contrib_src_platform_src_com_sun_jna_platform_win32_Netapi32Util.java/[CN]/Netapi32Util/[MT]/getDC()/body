{
  PDOMAIN_CONTROLLER_INFO.ByReference pdci=new PDOMAIN_CONTROLLER_INFO.ByReference();
  int rc=Netapi32.INSTANCE.DsGetDcName(null,null,null,null,0,pdci);
  if (W32Errors.ERROR_SUCCESS != rc) {
    throw new Win32Exception(rc);
  }
  DomainController dc=new DomainController();
  dc.address=pdci.dci.DomainControllerAddress.toString();
  dc.addressType=pdci.dci.DomainControllerAddressType;
  dc.clientSiteName=pdci.dci.ClientSiteName.toString();
  dc.dnsForestName=pdci.dci.DnsForestName.toString();
  dc.domainGuid=pdci.dci.DomainGuid;
  dc.domainName=pdci.dci.DomainName.toString();
  dc.flags=pdci.dci.Flags;
  dc.name=pdci.dci.DomainControllerName.toString();
  rc=Netapi32.INSTANCE.NetApiBufferFree(pdci.getPointer());
  if (LMErr.NERR_Success != rc) {
    throw new Win32Exception(rc);
  }
  return dc;
}
