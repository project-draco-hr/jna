{
  File lib=new File(libName);
  if (lib.isAbsolute()) {
    searchPath=Arrays.asList(new String[]{lib.getParent()});
  }
  FilenameFilter filter=new FilenameFilter(){
    public boolean accept(    File dir,    String filename){
      return (filename.startsWith("lib" + libName + ".so") || (filename.startsWith(libName + ".so") && libName.startsWith("lib"))) && isVersionedName(filename);
    }
  }
;
  List matches=new LinkedList();
  for (Iterator it=searchPath.iterator(); it.hasNext(); ) {
    File[] files=new File((String)it.next()).listFiles(filter);
    if (files != null && files.length > 0) {
      matches.addAll(Arrays.asList(files));
    }
  }
  double bestVersion=-1;
  String bestMatch=null;
  for (Iterator it=matches.iterator(); it.hasNext(); ) {
    String path=((File)it.next()).getAbsolutePath();
    String ver=path.substring(path.lastIndexOf(".so.") + 4);
    double version=parseVersion(ver);
    if (version >= bestVersion) {
      bestVersion=version;
      bestMatch=path;
    }
  }
  return bestMatch;
}
