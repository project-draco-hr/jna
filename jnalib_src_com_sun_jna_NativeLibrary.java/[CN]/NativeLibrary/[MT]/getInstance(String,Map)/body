{
  if (libraryName == null)   throw new NullPointerException("Library name may not be null");
synchronized (libraries) {
    WeakReference ref=(WeakReference)libraries.get(libraryName);
    NativeLibrary library=ref != null ? (NativeLibrary)ref.get() : null;
    if (library == null) {
      library=loadLibrary(libraryName,options);
      ref=new WeakReference(library);
      libraries.put(library.getName(),ref);
      libraries.put(library.getFile().getAbsolutePath(),ref);
      libraries.put(library.getFile().getName(),ref);
    }
    return library;
  }
}
