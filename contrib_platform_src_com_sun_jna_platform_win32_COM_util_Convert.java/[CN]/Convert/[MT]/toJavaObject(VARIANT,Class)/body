{
  if (null == value) {
    return null;
  }
  boolean concreteClassRequested=targetClass != null && (!targetClass.isAssignableFrom(Object.class));
  if (concreteClassRequested && targetClass.isAssignableFrom(value.getClass())) {
    return value;
  }
  Object vobj=value.getValue();
  if (vobj != null && concreteClassRequested && targetClass.isAssignableFrom(vobj.getClass())) {
    return vobj;
  }
  if (vobj instanceof VARIANT) {
    vobj=((VARIANT)vobj).getValue();
  }
  if (vobj instanceof WinDef.BOOL) {
    return ((WinDef.BOOL)vobj).booleanValue();
  }
 else   if (vobj instanceof VARIANT_BOOL) {
    return ((VARIANT_BOOL)vobj).booleanValue();
  }
 else   if (vobj instanceof WinDef.LONG) {
    return ((WinDef.LONG)vobj).longValue();
  }
 else   if (vobj instanceof WinDef.SHORT) {
    return ((WinDef.SHORT)vobj).shortValue();
  }
 else   if (vobj instanceof WinDef.UINT) {
    return ((WinDef.UINT)vobj).intValue();
  }
 else   if (vobj instanceof WinDef.WORD) {
    return ((WinDef.WORD)vobj).intValue();
  }
 else   if (vobj instanceof WTypes.BSTR) {
    return ((WTypes.BSTR)vobj).getValue();
  }
  return vobj;
}
