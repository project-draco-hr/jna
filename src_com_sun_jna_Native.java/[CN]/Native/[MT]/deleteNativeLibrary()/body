{
  String path=nativeLibraryPath;
  if (path == null || !unpacked)   return true;
  File flib=new File(path);
  if (flib.delete()) {
    nativeLibraryPath=null;
    unpacked=false;
    return true;
  }
  try {
    ClassLoader cl=Native.class.getClassLoader();
    Field f=ClassLoader.class.getDeclaredField("nativeLibraries");
    f.setAccessible(true);
    List libs=(List)f.get(cl);
    for (Iterator i=libs.iterator(); i.hasNext(); ) {
      Object lib=i.next();
      f=lib.getClass().getDeclaredField("name");
      f.setAccessible(true);
      String name=(String)f.get(lib);
      if (name.equals(path) || name.indexOf(path) != -1 || name.equals(flib.getCanonicalPath())) {
        Method m=lib.getClass().getDeclaredMethod("finalize",new Class[0]);
        m.setAccessible(true);
        m.invoke(lib,new Object[0]);
        nativeLibraryPath=null;
        if (unpacked) {
          if (flib.exists()) {
            if (flib.delete()) {
              unpacked=false;
              return true;
            }
            return false;
          }
        }
        return true;
      }
    }
  }
 catch (  Exception e) {
  }
  return false;
}
