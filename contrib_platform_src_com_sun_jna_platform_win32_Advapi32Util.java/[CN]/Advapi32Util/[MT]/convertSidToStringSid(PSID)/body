{
  PointerByReference stringSid=new PointerByReference();
  if (!Advapi32.INSTANCE.ConvertSidToStringSid(sid,stringSid)) {
    throw new Win32Exception(Kernel32.INSTANCE.GetLastError());
  }
  String result=stringSid.getValue().getWideString(0);
  Kernel32.INSTANCE.LocalFree(stringSid.getValue());
  return result;
}
