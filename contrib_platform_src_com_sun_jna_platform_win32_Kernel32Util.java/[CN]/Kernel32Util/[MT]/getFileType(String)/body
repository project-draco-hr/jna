{
  File f=new File(fileName);
  if (!f.exists()) {
    throw new FileNotFoundException(fileName);
  }
  HANDLE hFile=null;
  try {
    hFile=Kernel32.INSTANCE.CreateFile(fileName,WinNT.GENERIC_READ,WinNT.FILE_SHARE_READ,new WinBase.SECURITY_ATTRIBUTES(),WinNT.OPEN_EXISTING,WinNT.FILE_ATTRIBUTE_NORMAL,new HANDLEByReference().getValue());
    if (WinBase.INVALID_HANDLE_VALUE.equals(hFile)) {
      throw new Win32Exception(Kernel32.INSTANCE.GetLastError());
    }
    int type=Kernel32.INSTANCE.GetFileType(hFile);
switch (type) {
case WinNT.FILE_TYPE_UNKNOWN:
      int err=Kernel32.INSTANCE.GetLastError();
switch (err) {
case W32Errors.NO_ERROR:
      break;
default :
    throw new Win32Exception(err);
}
default :
return type;
}
}
  finally {
if (hFile != null) {
if (!Kernel32.INSTANCE.CloseHandle(hFile)) {
throw new Win32Exception(Kernel32.INSTANCE.GetLastError());
}
}
}
}
