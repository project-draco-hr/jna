{
  super.setUp();
  HRESULT hr=Ole32.INSTANCE.CoInitializeEx(null,Ole32.COINIT_MULTITHREADED);
  if (W32Errors.FAILED(hr)) {
    this.tearDown();
    throw new COMException("CoInitializeEx() failed: " + Kernel32Util.formatMessage(hr));
  }
  CLSID clsid=new CLSID();
  hr=Ole32.INSTANCE.CLSIDFromProgID("InternetExplorer.Application",clsid);
  if (W32Errors.FAILED(hr)) {
    Ole32.INSTANCE.CoUninitialize();
    throw new COMException("CLSIDFromProgID() failed: " + Kernel32Util.formatMessage(hr));
  }
  hr=Ole32.INSTANCE.CoCreateInstance(clsid,null,WTypes.CLSCTX_LOCAL_SERVER,IDispatch.IID_IDispatch,this.pDispatch);
  if (W32Errors.FAILED(hr)) {
    throw new COMException("Internet Explorer not registered properly");
  }
  this.iDispatch=new IDispatch(pDispatch.getPointer());
}
