{
class TestStructureLazy extends Structure {
    public TestStructureLazy(    Pointer p){
      super(p);
    }
    public int field1;
    public int fieldCount(){
      ensureAllocated();
      return fields().size();
    }
  }
  try {
    TestStructureLazy lazy=new TestStructureLazy(new Memory(2));
    lazy.ensureAllocated();
    fail("Exception should be thrown if provided memory is insufficiently large");
  }
 catch (  IllegalArgumentException e) {
  }
}
