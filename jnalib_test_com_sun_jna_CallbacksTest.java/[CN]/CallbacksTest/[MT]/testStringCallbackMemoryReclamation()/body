{
  TestLibrary.StringCallback cb=new TestLibrary.StringCallback(){
    public String callback(    String arg){
      return arg;
    }
  }
;
  Map m=CallbackReference.allocations;
  String arg=getName() + "1";
  String value=lib.callStringCallback(cb,arg);
  WeakReference ref=new WeakReference(value);
  arg=null;
  value=null;
  System.gc();
  for (int i=0; i < 100 && ref.get() != null; ++i) {
    try {
      Thread.sleep(1);
    }
  finally {
    }
  }
  assertNull("String reference not GC'd",ref.get());
  assertEquals("NativeString reference still held",0,m.values().size());
}
