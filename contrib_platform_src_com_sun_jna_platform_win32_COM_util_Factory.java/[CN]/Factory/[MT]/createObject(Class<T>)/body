{
  try {
    ComObject comObectAnnotation=comInterface.getAnnotation(ComObject.class);
    if (null == comObectAnnotation) {
      throw new COMException("createObject: Interface must define a value for either clsId or progId via the ComInterface annotation");
    }
    final GUID guid=this.discoverClsId(comObectAnnotation);
    final PointerByReference ptrDisp=new PointerByReference();
    WinNT.HRESULT hr=this.comThread.execute(new Callable<WinNT.HRESULT>(){
      @Override public WinNT.HRESULT call() throws Exception {
        return Ole32.INSTANCE.CoCreateInstance(guid,null,WTypes.CLSCTX_SERVER,IDispatch.IID_IDISPATCH,ptrDisp);
      }
    }
);
    COMUtils.checkRC(hr);
    Dispatch d=new Dispatch(ptrDisp.getValue());
    T t=this.createProxy(comInterface,d);
    int n=d.Release();
    return t;
  }
 catch (  InterruptedException e) {
    throw new RuntimeException(e);
  }
catch (  ExecutionException e) {
    throw new RuntimeException(e);
  }
catch (  TimeoutException e) {
    throw new RuntimeException(e);
  }
}
