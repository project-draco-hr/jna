{
  Native.setProtected(true);
  HRESULT hr=Ole32.INSTANCE.CoInitialize(null);
  if (W32Errors.FAILED(hr)) {
    this.release();
    throw new AutomationException("CoInitialize() failed!");
  }
  CLSID.ByReference clsid=new CLSID.ByReference();
  hr=Ole32.INSTANCE.CLSIDFromProgID(progId,clsid);
  if (W32Errors.FAILED(hr)) {
    Ole32.INSTANCE.CoUninitialize();
    throw new AutomationException("CLSIDFromProgID() failed!");
  }
  hr=Ole32.INSTANCE.CoCreateInstance(clsid,null,WTypes.CLSCTX_LOCAL_SERVER,IDispatch.IID_IDispatch,this.pDispatch);
  if (W32Errors.FAILED(hr)) {
    throw new AutomationException("COM object '" + progId + "' not registered properly!");
  }
  this.iDispatch=new IDispatch(this.pDispatch.getValue());
}
