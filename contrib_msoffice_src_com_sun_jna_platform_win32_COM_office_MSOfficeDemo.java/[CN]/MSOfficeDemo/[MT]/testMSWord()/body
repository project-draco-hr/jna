{
  MSWord msWord=null;
  LONG wdFormatPDF=new LONG(17);
  LONG wdFormatRTF=new LONG(6);
  LONG wdFormatHTML=new LONG(8);
  LONG wdFormatDocument=new LONG(0);
  LONG wdFormatDocumentDefault=new LONG(16);
  LONG wdOriginalDocumentFormat=new LONG(1);
  LONG wdPromptUser=new LONG(2);
  LONG wdWordDocument=new LONG(0);
  try {
    msWord=new MSWord();
    System.out.println("MSWord version: " + msWord.getVersion());
    msWord.setVisible(true);
    msWord.openDocument(currentWorkingDir + "jnatest.doc",true);
    msWord.insertText("Hello from JNA! \n\n");
    Thread.currentThread().sleep(1000);
    msWord.SaveAs("C:\\TEMP\\jnatestSaveAs.doc",wdFormatDocument);
    msWord.SaveAs("C:\\TEMP\\jnatestSaveAs.pdf",wdFormatPDF);
    msWord.SaveAs("C:\\TEMP\\jnatestSaveAs.rtf",wdFormatRTF);
    msWord.SaveAs("C:\\TEMP\\jnatestSaveAs.html",wdFormatHTML);
    msWord.closeActiveDocument(false);
    msWord.newDocument();
    msWord.insertText("Hello from JNA! \n Please notice that JNA can control MS Word via the new COM interface! \nHere we are creating a new word document and we save it to the 'TEMP' directory!");
    msWord.SaveAs("C:\\TEMP\\jnatestNewDoc1.docx",wdFormatDocumentDefault);
    msWord.SaveAs("C:\\TEMP\\jnatestNewDoc2.docx",wdFormatDocumentDefault);
    msWord.SaveAs("C:\\TEMP\\jnatestNewDoc3.docx",wdFormatDocumentDefault);
    msWord.closeActiveDocument(false);
    msWord.openDocument("C:\\TEMP\\jnatestNewDoc1.docx",true);
    msWord.insertText("Hello some changes from JNA!\n");
    msWord.openDocument("C:\\TEMP\\jnatestNewDoc2.docx",true);
    msWord.insertText("Hello some changes from JNA!\n");
    msWord.openDocument("C:\\TEMP\\jnatestNewDoc3.docx",true);
    msWord.insertText("Hello some changes from JNA!\n");
    msWord.Save(false,wdPromptUser);
    msWord.quit();
  }
 catch (  InterruptedException ie) {
    ie.printStackTrace();
  }
catch (  COMException e) {
    if (e.getExcepInfo() != null) {
      System.out.println("bstrSource: " + e.getExcepInfo().bstrSource);
      System.out.println("bstrDescription: " + e.getExcepInfo().bstrDescription);
    }
    e.printStackTrace();
    if (msWord != null)     msWord.quit();
  }
}
