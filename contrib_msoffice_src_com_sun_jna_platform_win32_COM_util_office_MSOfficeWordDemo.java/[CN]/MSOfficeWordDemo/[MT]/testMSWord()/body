{
  ComWord_Application msWordObject=null;
  ComIApplication msWord=null;
  Factory factory=null;
  try {
    String tempDir=System.getProperty("java.io.tmpdir");
    System.out.println("Files in temp dir: " + tempDir);
    factory=new Factory();
    msWordObject=factory.createObject(ComWord_Application.class);
    msWord=msWordObject.queryInterface(ComIApplication.class);
    System.out.println("MSWord version: " + msWord.getVersion());
    msWord.setVisible(true);
    msWord.getDocuments().Open(currentWorkingDir + "jnatest.doc");
    msWord.getSelection().TypeText("Hello from JNA! \n\n");
    Thread.sleep(1000);
    msWord.getActiveDocument().SaveAs(tempDir + "\\jnatestSaveAs.doc",WdSaveFormat.wdFormatDocument);
    msWord.getActiveDocument().SaveAs(tempDir + "\\jnatestSaveAs.pdf",WdSaveFormat.wdFormatPDF);
    msWord.getActiveDocument().SaveAs(tempDir + "\\jnatestSaveAs.rtf",WdSaveFormat.wdFormatRTF);
    msWord.getActiveDocument().SaveAs(tempDir + "\\jnatestSaveAs.html",WdSaveFormat.wdFormatHTML);
    msWord.getActiveDocument().Close(false);
    msWord.getDocuments().Add();
    msWord.getSelection().TypeText("Hello from JNA! \n Please notice that JNA can control MS Word via the new COM interface! \nHere we are creating a new word document and we save it to the 'TEMP' directory!");
    msWord.getActiveDocument().SaveAs(tempDir + "\\jnatestNewDoc1.docx",WdSaveFormat.wdFormatDocumentDefault);
    msWord.getActiveDocument().SaveAs(tempDir + "\\jnatestNewDoc2.docx",WdSaveFormat.wdFormatDocumentDefault);
    msWord.getActiveDocument().SaveAs(tempDir + "\\jnatestNewDoc3.docx",WdSaveFormat.wdFormatDocumentDefault);
    msWord.getActiveDocument().Close(false);
    msWord.getDocuments().Open(tempDir + "\\jnatestNewDoc1.docx");
    msWord.getSelection().TypeText("Hello some changes from JNA!\n");
    msWord.getDocuments().Open(tempDir + "\\jnatestNewDoc2.docx");
    msWord.getSelection().TypeText("Hello some changes from JNA!\n");
    msWord.getDocuments().Open(tempDir + "\\jnatestNewDoc3.docx");
    msWord.getSelection().TypeText("Hello some changes from JNA!\n");
    msWord.getDocuments().Save(false,WdOriginalFormat.wdPromptUser);
    msWord.Quit();
    msWord=null;
  }
 catch (  InterruptedException ie) {
    ie.printStackTrace();
  }
catch (  COMException e) {
    if (e.getExcepInfo() != null) {
      System.out.println("bstrSource: " + e.getExcepInfo().bstrSource);
      System.out.println("bstrDescription: " + e.getExcepInfo().bstrDescription);
    }
    e.printStackTrace();
  }
 finally {
    if (msWord != null) {
      msWord.Quit();
    }
    if (null != factory) {
      factory.getComThread().terminate(500);
    }
  }
}
