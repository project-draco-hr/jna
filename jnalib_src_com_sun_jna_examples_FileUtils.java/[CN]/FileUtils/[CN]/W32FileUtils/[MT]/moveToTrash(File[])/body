{
  Shell32 shell=Shell32.INSTANCE;
  SHFILEOPSTRUCTW fileop=new SHFILEOPSTRUCTW();
  fileop.wFunc=Shell32.FO_DELETE;
  String[] paths=new String[files.length];
  for (int i=0; i < paths.length; i++) {
    paths[i]=files[i].getAbsolutePath();
  }
  fileop.pFrom=fileop.encodePaths(paths);
  fileop.fFlags=Shell32.FOF_ALLOWUNDO | Shell32.FOF_NOCONFIRMATION | Shell32.FOF_SILENT;
  return shell.SHFileOperationW(fileop) == 0;
}
