{
  HRESULT hr=Ole32.INSTANCE.CoInitializeEx(null,Ole32.COINIT_MULTITHREADED);
  assertTrue("CoInitializeEx failed: " + Kernel32Util.formatMessage(hr),W32Errors.SUCCEEDED(hr));
  initialized=true;
  final String NAME="Shell.Application";
  CLSID clsid=new CLSID();
  hr=Ole32.INSTANCE.CLSIDFromProgID(NAME,clsid);
  assertTrue("CLSIDFromProgID(" + NAME + ") failed: "+ Kernel32Util.formatMessage(hr),W32Errors.SUCCEEDED(hr));
  final String IID_IShellDispatch="{D8F015C0-C278-11CE-A49E-444553540000}";
  GUID iid=Ole32Util.getGUIDFromString(IID_IShellDispatch);
  PointerByReference pDispatch=new PointerByReference();
  hr=Ole32.INSTANCE.CoCreateInstance(clsid,null,WTypes.CLSCTX_LOCAL_SERVER,iid,pDispatch);
  assertTrue("Error looking up Shell/IShellDispatch: " + Kernel32Util.formatMessage(hr),W32Errors.SUCCEEDED(hr));
  assertNotNull("Returned dispatch pointer should be non-null",pDispatch.getValue());
}
